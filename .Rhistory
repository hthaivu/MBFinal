geom_line(aes(x=date,y=NetCDS), color="dark blue", width = 2)
ggplot(jpMorgan) +
geom_line(aes(x=date,y=NetCDS), color="dark blue", line_width = 2)
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue")
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017")
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017")+
scale_x_continuous(breaks = seq(2006, 2017, 12))
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017")+
scale_x_discrete(breaks = seq(2006, 2017, 12))
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017")+
scale_x_discrete(limits = 2006:2017)
ggplot(cdsSummary) +
geom_line(aes(x=factor(date),y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017")+
scale_x_discrete(limits = 2006:2017)
ggplot(cdsSummary) +
geom_line(aes(x=factor(date),y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017")
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017")+
scale_x_discrete(limits = 2006:2017)
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017")+
scale_x_discrete()
test =read.table("data/bhcf1703.txt",sep="^", nrows=1300, comment.char="", header=TRUE, quote="", na.strings="--------", as.is=TRUE)
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017")
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34))
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_continuous(breaks=c(2006,2008,2010,2012,2014,2016,2018))
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
axis.Date(1,date)
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_continuous(breaks=as.Date(c(2006,2008,2010,2012,2014,2016,2018)))
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y")
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_linedraw()
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw()
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_tufte()
library(tufte)
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_tufte()
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_tufte()
library(ggthemes)
install.packages("ggthemes")
library(ggthemes)
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_tufte()
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_tufte() +
geom_rangeframe()
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw() +
####### Analysis
test =read.table("data/bhcf1703.txt",sep="^", nrows=1300, comment.char="", header=TRUE, quote="", na.strings="--------", as.is=TRUE)
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw()
source('D:/Macalester/Spring 2018/Money & Banking/Final Project/bhcScript.R', echo=TRUE)
ggplot(cdsSummary) +
geom_line(aes(x=date,y=count), color="dark blue") +
labs(x = "Date", y = "Number of Banks", title = "Banks With Non-Zero CDS Balance", subtitle = "Period 2006-2017") +
scale_y_continuous(breaks=c(20,22,24,26,28,30,32,34)) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
theme_bw()
ggplot(jpMorgan) +
geom_line(aes(x=date,y=NetCDS))
ggplot(jpMorgan) +
geom_point(aes(x=Loans/Assets, y=NetCDS))
ggplot(cdsTimeSeries) %>%
geom_point(aes(x=date, y=Loans/Assets))
cdsTimeSeries = rbind(cdsTimeSeries,barclays) %>%
mutate(leverage = Loans/Assets)
cdsTimeSeries = rbind(cdsTimeSeries,barclays) %>%
mutate(leverage = totalLoans/totalAssets)
ggplot(cdsTimeSeries) %>%
geom_point(aes(x=date, y=leverage))
ggplot(cdsTimeSeries) %>%
geom_point(aes(x=netCDS, y=leverage))
ggplot(cdsTimeSeries) %>%
geom_point(aes(x=date, y=netCDS))
ggplot(cdsTimeSeries) %>%
geom_point(aes(x=date, y=netCDS))
ggplot(cdsTimeSeries) +
geom_point(aes(x=date, y=netCDS))
ggplot(cdsTimeSeries) +
geom_point(aes(x=date, y=leverage))
write_csv(cdsTimeSeries,"/data/cdsTimeSeries.csv")
write_csv(cdsTimeSeries,"data/cdsTimeSeries.csv")
ggplot(cdsTimeSeries) +
geom_point(aes(x=date, y=leverage, color = bankName))
ggplot(cdsTimeSeries) +
geom_point(aes(x=leverage, y=cdsNetBuy, color = bankName))
ggplot(cdsTimeSeries) +
geom_point(aes(x=leverage, y=cdsNetBuy))
ggplot(cdsTimeSeries) +
geom_point(aes(x=leverage, y=log(cdsNetBuy)))
ggplot(cdsTimeSeries) +
geom_point(aes(x=leverage, y=log(cdsNetBuy), size = totalAssets))
ggplot(cdsTimeSeries) +
geom_point(aes(x=leverage, y=log(cdsNetBuy), size = totalAssets), alpha = 0.6)
ggplot(cdsTimeSeries) +
geom_point(aes(x=leverage, y=log(cdsNetBuy), size = totalAssets), alpha = 0.25)
ggplot(cdsTimeSeries) +
geom_point(aes(x=leverage, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
lm(cdsTimeSeries,log(cdsNetBuy) ~ leverage)
cdsTimeSeries = rbind(cdsTimeSeries,barclays) %>%
mutate(leverage = totalLoans/totalAssets, logNetCDS = log(cdsNetBuy))
View(barclays)
cdsTimeSeriesX = cdsTimeSeries %>%
mutate(leverage = totalLoans/totalAssets, logNetCDS = log(cdsNetBuy))  %>%
group_by_all()%>%
summarise()
View(cdsTimeSeriesX)
cdsTimeSeries = cdsTimeSeries %>%
mutate(leverage = totalLoans/totalAssets, logNetCDS = log(cdsNetBuy))  %>%
group_by_all()%>%
summarise()
cdsTimeSeries = cdsTimeSeries %>%
mutate(leverage = totalLoans/totalAssets, logNetCDS = log(cdsNetBuy))
cdsTimeSeries = cdsTimeSeries %>%
mutate(leverage = totalLoans/totalAssets, logNetCDS = log(cdsNetBuy))  %>%
ungroup()
ggplot(cdsTimeSeries) +
geom_point(aes(x=leverage, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
lm(cdsTimeSeries,logNetCDS ~ leverage)
lm(logNetCDS ~ leverage, data = cdsTimeSeries)
lm(cdsNetBuy ~ leverage, data = cdsTimeSeries)
cdsLeverage = lm(cdsNetBuy ~ leverage, data = cdsTimeSeries)
summary(cdsLeverage)
cdsLeverage = lm(cdsNetBuy ~ leverage + totalAssets, data = cdsTimeSeries)
summary(cdsLeverage)
cdsLeverage = lm(cdsNetBuy ~ leverage + totalAssets + loansCI_US, data = cdsTimeSeries)
summary(cdsLeverage)
# Statistical Analysis
cdsLeverage = lm(cdsNetBuy ~ totalAssets + loansCI_US, data = cdsTimeSeries)
summary(cdsLeverage)
ggplot(cdsTimeSeries) +
geom_point(aes(x=loansCI_US, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=loansCI_US/totalLoans, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=loansCI_US/totalAssets, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
# Statistical Analysis
cdsLeverage = lm(cdsNetBuy ~ totalAssets + loansCI_US/totalAssets, data = cdsTimeSeries)
summary(cdsLeverage)
# Statistical Analysis
cdsLeverage = lm(cdsNetBuy ~ totalAssets*loansCI_US, data = cdsTimeSeries)
summary(cdsLeverage)
ggplot(cdsTimeSeries) +
geom_point(aes(x=log(loansCI_US), y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
/totalAssets
ggplot(cdsTimeSeries) +
geom_point(aes(x=loansCI_US/totalAssets, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
cdsTimeSeries = cdsTimeSeries %>%
mutate(leverage = totalLoans/totalAssets,
logNetCDS = log(cdsNetBuy),
exposureCI_US = loansCI_US/totalLoans)
cdsTimeSeries = cdsTimeSeries %>%
ungroup %>%
mutate(leverage = totalLoans/totalAssets,
logNetCDS = log(cdsNetBuy),
exposureCI_US = loansCI_US/totalLoans)
# Statistical Analysis
cdsLeverage = lm(cdsNetBuy ~ totalAssets +exposureCI_US, data = cdsTimeSeries)
summary(cdsLeverage)
# Statistical Analysis
cdsLeverage = lm(cdsNetBuy ~ totalAssets +exposureCI_US + leverage, data = cdsTimeSeries)
summary(cdsLeverage)
cdsTimeSeries = cdsTimeSeries %>%
ungroup %>%
mutate(leverage = totalLoans/totalAssets,
logNetCDS = log(cdsNetBuy),
exposureCI_US = loansCI_US/totalAssets)
# Statistical Analysis
cdsLeverage = lm(cdsNetBuy ~ totalAssets +exposureCI_US , data = cdsTimeSeries)
summary(cdsLeverage)
ggplot(cdsTimeSeries) +
geom_point(aes(x=loansCI_US, y=cdsNetBuy, size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=log(loansCI_US), y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=exposureCI, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
# Statistical Analysis
cdsLeverage = lm(cdsNetBuy ~ exposureCI_US , data = cdsTimeSeries)
summary(cdsLeverage)
totalAssets +
totalAssets +
# Statistical Analysis
cdsLeverage = lm(cdsNetBuy ~ totalAssets +exposureCI_US , data = cdsTimeSeries)
summary(cdsLeverage)
test =read.table("data/bhcf1703.txt",sep="^", nrows=1300, comment.char="", header=TRUE, quote="", na.strings="--------", as.is=TRUE)
top30Banks =cdsTimeSeries %>%
group_by(bankName)%>%
summarise(meanAssets = mean(totalAssets)) %>%
arrange(desc(meanAssets)) %>%
head(30)
View(top30Banks)
top30BankCDS = cdsTimeSeries %>%
filter(bankName %in% top30Banks$bankName)
ggplot(top30BankCDS) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
length(unique(cdsTimeSeries$bankName))
ggplot(cdsTimeSeries) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = log(totalAssets)), alpha = 0.5)
ggplot(top30BankCDS) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
top30Banks =cdsTimeSeries %>%
group_by(bankName)%>%
summarise(meanAssets = mean(totalAssets)) %>%
arrange(desc(meanAssets)) %>%
head(10)
top30BankCDS = cdsTimeSeries %>%
filter(bankName %in% top30Banks$bankName)
ggplot(jpMorgan) +
geom_point(aes(x=Loans/Assets, y=NetCDS))
top30BankCDS = cdsTimeSeries %>%
filter(bankName %in% top30Banks$bankName)
ggplot(top30BankCDS) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
ggplot(top30BankCDS) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
top30Banks =cdsTimeSeries %>%
group_by(bankName)%>%
summarise(meanAssets = mean(totalAssets)) %>%
arrange(desc(meanAssets)) %>%
head(20)
top30BankCDS = cdsTimeSeries %>%
filter(bankName %in% top30Banks$bankName)
ggplot(top30BankCDS) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets, color = bankName), alpha = 0.5)
ggplot(top30BankCDS) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets, color = bankName), alpha = 0.5)
ggplot(top20BankCDS) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
top20Banks =cdsTimeSeries %>%
group_by(bankName)%>%
summarise(meanAssets = mean(totalAssets)) %>%
arrange(desc(meanAssets)) %>%
head(20)
top20BankCDS = cdsTimeSeries %>%
filter(bankName %in% top20Banks$bankName)
ggplot(top20BankCDS) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy), size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
ggplot(top20BankCDS) +
geom_point(aes(x=exposureCI_US, y=cdsNetBuy/loansCI_US, size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
ggplot(top20BankCDS) +
geom_point(aes(x=exposureCI_US, y=cdsNetBuy/totalAssets, size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
ggplot(top20BankCDS) +
geom_point(aes(x=exposureCI_US, y=log(cdsNetBuy/loansCI_US), size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
ggplot(top20BankCDS) +
geom_point(aes(x=log(exposureCI_US), y=log(cdsNetBuy/loansCI_US), color = bankName), alpha = 0.5)
ggplot(top20BankCDS) +
geom_point(aes(x=log(exposureCI_US), y=log(cdsNetBuy/loansCI_US), color = bankName), alpha = 0.75)
cdsTimeSeries = cdsTimeSeries %>%
ungroup %>%
mutate(leverage = totalLoans/totalAssets,
logNetCDS = log(cdsNetBuy),
loansCI_to_totalAssets = loansCI_US/totalAssets,
loansCI_to_totalLoans = loansCI_US/totalLoans)  %>%
select(-exposureCI_US)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(cdsNetBuy/loansCI_US), color = bankName), alpha = 0.75)
ggplot(top20BankCDS) +
geom_point(aes(x=loansCI_to_totalLoans, y=log(cdsNetBuy), size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
top20Banks =cdsTimeSeries %>%
group_by(bankName)%>%
summarise(meanAssets = mean(totalAssets)) %>%
arrange(desc(meanAssets)) %>%
head(20)
top20BankCDS = cdsTimeSeries %>%
filter(bankName %in% top20Banks$bankName)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(cdsNetBuy/loansCI_US), color = bankName), alpha = 0.75)
ggplot(top20BankCDS) +
geom_point(aes(x=loansCI_to_totalLoans, y=cdsNetBuy/totalAssets, size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
ggplot(top20BankCDS) +
geom_point(aes(x=loansCI_to_totalAssets, y=cdsNetBuy/totalAssets, size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalAssets), y=log(cdsNetBuy/totalAssets), size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
cdsTimeSeries = cdsTimeSeries %>%
ungroup %>%
mutate(leverage = totalLoans/totalAssets,
logNetCDS = log(cdsNetBuy),
loansCI_to_totalAssets = loansCI_US/totalAssets,
loansCI_to_totalLoans = loansCI_US/totalLoans,
netCDS_to_loansCI = cdsNetBuy/loansCI_US)
cdsTimeSeries = cdsTimeSeries %>%
ungroup %>%
mutate(leverage = totalLoans/totalAssets,
loansCI_to_totalAssets = loansCI_US/totalAssets,
loansCI_to_totalLoans = loansCI_US/totalLoans,
netCDS_to_loansCI = cdsNetBuy/loansCI_US)
top20Banks =cdsTimeSeries %>%
group_by(bankName)%>%
summarise(meanAssets = mean(totalAssets)) %>%
arrange(desc(meanAssets)) %>%
head(20)
top20BankCDS = cdsTimeSeries %>%
filter(bankName %in% top20Banks$bankName)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalAssets), y=log(cdsNetBuy/totalAssets), size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
cdsLoansCI = lm(NetCDS ~ loansCI_to_totalLoans , data = cdsTimeSeries)
summary(cdsLoansCI)
cdsLoansCI = lm(NetCDS_to_loansCI ~ loansCI_to_totalLoans , data = cdsTimeSeries)
summary(cdsLoansCI)
cdsLoansCI = lm(netCDS_to_loansCI ~ loansCI_to_totalLoans , data = cdsTimeSeries)
cdsLoansCI = lm(netCDS_to_loansCI ~ loansCI_to_totalLoans , data = cdsTimeSeries, na.action = na.exclude)
cdsTimeSeries = cdsTimeSeries %>%
ungroup %>%
mutate(leverage = totalLoans/totalAssets,
loansCI_to_totalAssets = loansCI_US/totalAssets,
loansCI_to_totalLoans = loansCI_US/totalLoans,
netCDS_to_loansCI = cdsNetBuy/loansCI_US) %>%
filter(loansCI_US != 0)
top20Banks =cdsTimeSeries %>%
group_by(bankName)%>%
summarise(meanAssets = mean(totalAssets)) %>%
arrange(desc(meanAssets)) %>%
head(20)
top20BankCDS = cdsTimeSeries %>%
filter(bankName %in% top20Banks$bankName)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalAssets), y=log(cdsNetBuy/totalAssets), size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
cdsLoansCI = lm(netCDS_to_loansCI ~ loansCI_to_totalLoans , data = cdsTimeSeries, na.action = na.exclude)
summary(cdsLoansCI)
ggplot(cdsTimeSeries) +
geom_point(aes(x=loansCI_to_totalLoans, y=netCDS_to_loansCI, size = totalAssets, color = bankName), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=loansCI_to_totalLoans, y=netCDS_to_loansCI, size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(netCDS_to_loansCI), size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(netCDS_to_loansCI), size = totalAssets), alpha = 0.25)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(cdsNetBuy/loansCI_US), color = bankName), alpha = 0.75)
ggplot(cdsTimeSeries) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(netCDS_to_loansCI), size = totalAssets), alpha = 0.25)
# library
library(tidyverse)
library(ggplot2)
library(GGally)
library(lubridate)
library(tufte)
library(ggthemes)
library(tidyverse)
library(ggplot2)
library(GGally)
library(lubridate)
library(tufte)
library(ggthemes)
knitr::opts_chunk$set(tidy = FALSE, message=FALSE, cache.extra = packageVersion('tufte'))
options(htmltools.dir.version = FALSE)
cdsTimeSeries = read_csv("data/cdsTimeSeries.csv")
barclays = mutate(barclays, bankShortName = "Barclays")
cdsTimeSeriesX = left_join(cdsTimeSeries,barclays)
View(cdsTimeSeriesX)
# Adding new metrics
cdsTimeSeries = cdsTimeSeries %>%
ungroup %>%
mutate(leverage = totalLoans/totalAssets,
loansCI_to_totalAssets = loansCI_US/totalAssets,
loansCI_to_totalLoans = loansCI_US/totalLoans,
netCDS_to_loansCI = cdsNetBuy/loansCI_US) %>%
filter(loansCI_US != 0)
# Save to csv
write_csv(cdsTimeSeries,"data/cdsTimeSeries.csv")
ggplot(cdsTimeSeries) +
geom_point(aes(x=loansCI_US, y=log(cdsNetBuy), size = totalAssets, color = bankName), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=loansCI_US, y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=loansCI_US, y=(cdsNetBuy), size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=log(loansCI_US), y=log(cdsNetBuy), size = totalAssets), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=log(loansCI_US), y=log(cdsNetBuy)), alpha = 0.5)
ggplot(cdsTimeSeries) +
geom_point(aes(x=log(loansCI_US), y=log(cdsNetBuy)), alpha = 0.5) +
geom_smooth(method='lm',formula=y~x)
ggplot(cdsTimeSeries,aes(x=log(loansCI_US), y=log(cdsNetBuy))) +
geom_point(alpha = 0.5) +
geom_smooth(method='lm',formula=y~x)
ggplot(cdsTimeSeries, aes(x=bankName, y=loansCI_US/totalLoans)) %>%
geom_boxplot()
ggplot(cdsTimeSeries,aes(x=bankName, y=loansCI_US/totalLoans)) +
geom_boxplot()
ggplot(top20BankCDS,aes(x=bankName, y=loansCI_US/totalLoans)) +
geom_boxplot()
ggplot(top20BankCDS,aes(x=bankName, y=loansCI_US/totalLoans)) +
geom_boxplot() +
flip_coord()
ggplot(top20BankCDS,aes(x=bankName, y=loansCI_US/totalLoans)) +
geom_boxplot() +
coord_flip()
View(unique(cdsTimeSeries$bankName))
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalAssets), y=log(cdsNetBuy/totalAssets), size = totalAssets, color = bankName), alpha = 0.5)+
scale_size_continuous(guide = FALSE)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(cdsNetBuy/loansCI_US), color = bankName), alpha = 0.75)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(cdsNetBuy/totalAssets), color = bankName), alpha = 0.75)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(cdsNetBuy/totalAssets), color = bankName), alpha = 0.75)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(cdsNetBuy/totalAssets)), alpha = 0.75)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(cdsNetBuy/totalAssets)), alpha = 0.75) +
geom_smooth()
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(cdsNetBuy/totalAssets)), alpha = 0.75) +
geom_smooth(method='lm',formula=y~x)
ggplot(top20BankCDS) +
geom_point(aes(x=log(loansCI_to_totalLoans), y=log(cdsNetBuy/totalAssets)), alpha = 0.75) +
geom_smooth(method='lm',formula=y~x)
ggplot(top20BankCDS,aes(x=log(loansCI_to_totalLoans), y=log(cdsNetBuy/totalAssets)))+
geom_point(alpha = 0.75) +
geom_smooth(method='lm',formula=y~x)
ggplot(top20BankCDS,aes(x=log(loansCI_to_totalAssets), y=log(cdsNetBuy/totalAssets)))+
geom_point(alpha = 0.75) +
geom_smooth(method='lm',formula=y~x)
cdsLoansCI = lm(netCDS_to_loansCI ~ loansCI_to_totalLoans , data = cdsTimeSeries, na.action = na.exclude)
summary(cdsLoansCI)
cdsLoansCI = lm(CDSNetBuy ~ loansCI_US + totalAssets , data = cdsTimeSeries, na.action = na.exclude)
cdsLoansCI = lm(cdsNetBuy ~ loansCI_US + totalAssets , data = cdsTimeSeries, na.action = na.exclude)
summary(cdsLoansCI)
